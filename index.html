<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>名前照合システム</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>名前照合システム</h1>
        
        <div class="upload-section">
            <div class="file-input-wrapper">
                <h2>①姓名が分かれたExcelファイル</h2>
                <input type="file" id="file1" accept=".xlsx,.xls" />
                <p class="file-info">姓と名が別々のセルに記載されているファイル</p>
            </div>
            
            <div class="file-input-wrapper">
                <h2>②照合対象のExcelファイル</h2>
                <input type="file" id="file2" accept=".xlsx,.xls" />
                <div class="name-format-selection">
                    <p class="format-label">姓名の記載形式：</p>
                    <label class="radio-label">
                        <input type="radio" name="file2Format" value="combined" checked>
                        <span>姓名が1つのセル</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="file2Format" value="separated">
                        <span>姓と名が別々のセル</span>
                    </label>
                </div>
            </div>
        </div>
        
        <div class="match-options">
            <h2>照合する項目を選択</h2>
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="matchName" checked disabled>
                    <span>氏名（必須）</span>
                </label>
                <label>
                    <input type="checkbox" id="matchKana">
                    <span>カナ氏名</span>
                </label>
                <label>
                    <input type="checkbox" id="matchSchool">
                    <span>学校名</span>
                </label>
                <label>
                    <input type="checkbox" id="matchBirthdate">
                    <span>生年月日</span>
                </label>
                <label>
                    <input type="checkbox" id="matchMobile">
                    <span>携帯番号</span>
                </label>
                <label>
                    <input type="checkbox" id="matchEmail">
                    <span>メールアドレス</span>
                </label>
            </div>
            <div class="column-mapping" id="columnMapping" style="display: none;">
                <h3>列の対応を指定してください</h3>
                <div id="mappingInputs"></div>
            </div>
            <div class="extract-columns" id="extractColumns" style="display: none;">
                <h3>抽出する列を指定してください（最大5列）</h3>
                <div id="extractInputs"></div>
                <button id="addExtractColumn" type="button">列を追加</button>
            </div>
        </div>
        
        <button id="compareBtn" disabled>照合開始</button>
        
        <div id="results" class="results-section"></div>
        <div id="exportSection" style="display: none; text-align: center; margin-top: 20px;">
            <button id="exportBtn" onclick="exportResults()">結果をCSVでダウンロード</button>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>